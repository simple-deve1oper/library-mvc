CREATE DATABASE library;

CREATE TABLE authors (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    last_name VARCHAR(60) NOT NULL,
    first_name VARCHAR(60) NOT NULL,
    middle_name VARCHAR(60),
    birth_date DATE NOT NULL
);

CREATE TABLE publishers (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL
);

CREATE TABLE books (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    author_id BIGINT NOT NULL REFERENCES authors (id) ON DELETE RESTRICT,
    publisher_id BIGINT REFERENCES publishers (id) ON DELETE RESTRICT,
    publication_year VARCHAR(10) NOT NULL,
    available BOOLEAN NOT NULL
);

CREATE TABLE people (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    last_name VARCHAR(60) NOT NULL,
    first_name VARCHAR(60) NOT NULL,
    middle_name VARCHAR(60),
    birth_date DATE NOT NULL,
    email VARCHAR(50) UNIQUE,
    phone_number VARCHAR(13) NOT NULL UNIQUE
);

CREATE TABLE reports (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    person_id BIGINT NOT NULL REFERENCES people (id) ON DELETE CASCADE,
    book_id BIGINT NOT NULL REFERENCES books (id) ON DELETE CASCADE,
    issue_date TIMESTAMP NOT NULL,
    return_date TIMESTAMP
);
